name: JLC Auto Sign

on:
  schedule:
    # 修正后：北京时间 0点、6点、12点、18点执行
    # 对应 UTC: 16, 22, 4, 10
    - cron: '0 4,10,16,22 * * *'
    # 修正后：北京时间 9:24 执行 (对应 UTC 1:24)
    - cron: '28 1 * * *'
  workflow_dispatch:

jobs:
  sign:
    runs-on: ubuntu-latest
    steps:
    - name: Checkout
      uses: actions/checkout@v3

    # 推荐：显式设置 Python 环境，比直接用系统自带的更稳定
    - name: Set up Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.9' 

    - name: Install dependencies
      run: |
        python -m pip install --upgrade pip
        # 方案A：如果有 requirements.txt
        if [ -f requirements.txt ]; then pip install -r requirements.txt; fi
        # 方案B：或者直接安装常用的库 (根据你的脚本需求修改)
        # pip install requests

    - name: Set timezone to Asia/Shanghai
      run: sudo timedatectl set-timezone Asia/Shanghai

    - name: Run Sign Script
      env:
        TOKEN_LIST: ${{ secrets.TOKEN_LIST }}
        SEND_KEY_LIST: ${{ secrets.SEND_KEY_LIST }}
      run: |
        python main.py
